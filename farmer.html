<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dairy Farmer Management</title>
    <link rel="stylesheet" href="farmer.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
</head>
<body>
    <div class="container">
        <div class="content">
            <h2><span class="material-symbols-outlined">supervisor_account</span> Dairy Farmer Management</h2>
            <div class="qc-navigation">
                <button class="nav-button active" data-section="farmer-database-section">
                    <span class="material-symbols-outlined">person</span> Farmer Database
                </button>
                <button class="nav-button" data-section="milk-tracking-section">
                    <span class="material-symbols-outlined">water_drop</span> Milk Supply Tracking
                </button>
                <button class="nav-button" data-section="payment-management-section">
                    <span class="material-symbols-outlined">payments</span> Payment Management
                </button>
                <button class="nav-button" data-section="communication-section">
                    <span class="material-symbols-outlined">chat</span> Communication
                </button>
                <button class="nav-button" data-section="performance-analytics-section">
                    <span class="material-symbols-outlined">insights</span> Performance & Analytics
                </button>
            </div>

            <section id="farmer-database-section" class="active">
                <h3><span class="material-symbols-outlined">person</span> Farmer Database</h3>
                <div class="controls">
                    <h4>Farmer Profiles</h4>
                    <button class="action-button inline-add-button" onclick="openAddFarmerModal()">
                        <span class="material-symbols-outlined">add</span> Add Farmer
                    </button>
                </div>
                <div class="data-table-container">
                    <table id="farmer-table" class="data-table">
                        <thead>
                            <tr>
                                <th class="filterable" data-type="text" data-column="farmerId">Farmer ID <span class="arrow">▼</span></th>
                                <th class="filterable" data-type="text" data-column="name">Name <span class="arrow">▼</span></th>
                                <th class="filterable" data-type="text" data-column="contact">Contact <span class="arrow">▼</span></th>
                                <th class="filterable" data-type="text" data-column="location">Location <span class="arrow">▼</span></th>
                                <th class="filterable" data-type="text" data-column="bankName">Bank Name <span class="arrow">▼</span></th>
                                <th class="filterable" data-type="text" data-column="ifsc">IFSC <span class="arrow">▼</span></th>
                                <th class="filterable" data-type="text" data-column="accountNumber">Account Number <span class="arrow">▼</span></th>
                                <th class="filterable" data-type="text" data-column="aadharNumber">Aadhar Number <span class="arrow">▼</span></th>
                                <th>Actions</th>
                            </tr>
                            <tr class="filter-row hidden">
                                <td><input type="text" class="filter-input" data-column="farmerId" placeholder="Farmer ID"></td>
                                <td><input type="text" class="filter-input" data-column="name" placeholder="Name"></td>
                                <td><input type="text" class="filter-input" data-column="contact" placeholder="Contact"></td>
                                <td><input type="text" class="filter-input" data-column="location" placeholder="Location"></td>
                                <td><input type="text" class="filter-input" data-column="bankName" placeholder="Bank Name"></td>
                                <td><input type="text" class="filter-input" data-column="ifsc" placeholder="IFSC"></td>
                                <td><input type="text" class="filter-input" data-column="accountNumber" placeholder="Account Number"></td>
                                <td><input type="text" class="filter-input" data-column="aadharNumber" placeholder="Aadhar Number"></td>
                                <td></td>
                            </tr>
                        </thead>
                        <tbody id="farmer-table-body">
                            </tbody>
                    </table>
                </div>
            </section>

            <section id="milk-tracking-section" style="display: none;">
                <h3><span class="material-symbols-outlined">water_drop</span> Milk Supply Tracking</h3>
                <div class="controls">
                    <h4>Milk Records</h4>
                    <button class="action-button inline-add-button" onclick="openAddMilkRecordModal()">
                        <span class="material-symbols-outlined">add</span> Add Milk Record
                    </button>
                </div>
                <div class="data-table-container">
                    <table id="milk-records-table" class="data-table">
                        <thead>
                            <tr>
                                <th class="filterable" data-type="text" data-column="farmerId">Farmer ID <span class="arrow">▼</span></th>
                                <th class="filterable" data-type="date" data-column="supplyDate">Supply Date <span class="arrow">▼</span></th>
                                <th class="filterable" data-type="number" data-column="milkQuantity">Quantity (Liters) <span class="arrow">▼</span></th>
                                <th class="filterable" data-type="number" data-column="fatContent">Fat Content (%) <span class="arrow">▼</span></th>
                                <th class="filterable" data-type="number" data-column="snfValue">SNF Value <span class="arrow">▼</span></th>
                                <th class="filterable" data-type="number" data-column="pricePerLiter">Price/Liter (₹) <span class="arrow">▼</span></th>
                                <th class="filterable" data-type="number" data-column="totalPrice">Total Price (₹) <span class="arrow">▼</span></th>
                                <th>Actions</th>
                            </tr>
                            <tr class="filter-row hidden">
                                <td><input type="text" class="filter-input" data-column="farmerId" placeholder="Farmer ID"></td>
                                <td><input type="date" class="filter-input" data-column="supplyDate" placeholder="Select Supply Date"></td>
                                <td><input type="number" class="filter-input" data-column="milkQuantity" placeholder="Enter Quantity in Liters"></td>
                                <td><input type="number" class="filter-input" data-column="fatContent" placeholder="Enter Fat Content (%)"></td>
                                <td><input type="number" class="filter-input" data-column="snfValue" placeholder="Enter SNF Value"></td>
                                <td><input type="number" class="filter-input" data-column="pricePerLiter" placeholder="Enter Price per Liter (₹)"></td>
                                <td></td>
                            </tr>
                        </thead>
                        <tbody id="milk-records-table-body">
                        </tbody>
                    </table>
                </div>
                <div class="bulk-entry-container">
                    <button class="bulk-entry-button" onclick="openBulkMilkEntryModal()">
                        <span class="material-symbols-outlined">batch_prediction</span> Bulk Entry
                    </button>
                </div>
                <div class="chart-container">
                    <h4>Milk Quantity Trend</h4>
                    <canvas id="milk-quantity-chart"></canvas>
                </div>
            </section>

            <section id="payment-management-section" style="display: none;">
                <h3><span class="material-symbols-outlined">payments</span> Payment Management</h3>
                <div class="controls">
                    <h4>Payment History</h4>
                    <button class="action-button inline-add-button" onclick="openAddPaymentModal()">
                        <span class="material-symbols-outlined">add</span> Record Payment
                    </button>
                </div>
                <div class="data-table-container">
                    <table id="payment-history-table" class="data-table">
                        <thead>
                            <tr>
                                <th class="filterable" data-type="text" data-column="farmerId">Farmer ID <span class="arrow">▼</span></th>
                                <th class="filterable" data-type="date" data-column="paymentDate">Payment Date <span class="arrow">▼</span></th>
                                <th class="filterable" data-type="text" data-column="paymentMethod">Payment Method <span class="arrow">▼</span></th>
                                <th class="filterable" data-type="text" data-column="transactionId">Transaction ID <span class="arrow">▼</span></th>
                                <th class="filterable" data-type="number" data-column="amount">Amount (₹) <span class="arrow">▼</span></th>
                                <th class="filterable" data-type="text" data-column="remarks">Remarks <span class="arrow">▼</span></th>
                                <th>Receipt</th>
                            </tr>
                            <tr class="filter-row hidden">
                                <td><input type="text" class="filter-input" data-column="farmerId" placeholder="Farmer ID"></td>
                                <td><input type="date" class="filter-input" data-column="paymentDate" placeholder="Select Payment Date"></td>
                                <td><input type="text" class="filter-input" data-column="paymentMethod" placeholder="Select Method"></td>
                                <td><input type="text" class="filter-input" data-column="transactionId" placeholder="Transaction ID"></td>
                                <td><input type="number" class="filter-input" data-column="amount" placeholder="Enter Payment Amount"></td>
                                <td><input type="text" class="filter-input" data-column="remarks" placeholder="Optional remarks..."></td>
                                <td></td>
                            </tr>
                        </thead>
                        <tbody id="payment-history-table-body">
                        </tbody>
                    </table>
                </div>
                <div class="chart-container">
                    <h4>Payment Mode Distribution</h4>
                    <canvas id="payment-mode-chart"></canvas>
                </div>
            </section>

            <section id="communication-section" style="display: none;">
                <h3><span class="material-symbols-outlined">chat</span> Communication</h3>
                <div class="communication-tools">
                    <button class="action-button" id="direct-message-button">
                        <span class="material-symbols-outlined">chat_bubble</span> Direct Message
                    </button>
                    <button class="action-button" id="group-broadcast-button">
                        <span class="material-symbols-outlined">groups</span> Group Broadcast
                    </button>
                    <button class="action-button" id="feedback-button">
                        <span class="material-symbols-outlined">feedback</span> Feedback & Grievances
                    </button>
                    <button class="action-button" id="resource-library-button">
                        <span class="material-symbols-outlined">library_books</span> Resource Library
                    </button>
                </div>
                <div class="message-log">
                    <h4>Communication Log</h4>
                    <ul id="message-list"></ul>
                </div>
            </section>

            <div id="direct-message-modal" class="modal" style="display: none;">
                <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <h4>Send Direct Message</h4>
                    <form id="direct-message-form">
                        <div class="form-group">
                            <label for="dm-farmer-id">Farmer ID:</label>
                            <input type="text" id="dm-farmer-id" name="farmer-id" required pattern="[A-Za-z0-9]{5}" maxlength="5" placeholder="Enter Farmer ID"/>
                            <span id="dm-farmer-id-error" class="error-message"></span>
                        </div>
                        <div class="form-group">
                            <label for="dm-message">Message:</label>
                            <textarea id="dm-message" name="message" rows="4" required placeholder="Enter your message"></textarea>
                            <span id="dm-message-error" class="error-message"></span>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="action-button">Send Message</button>
                        </div>
                    </form>
                </div>
            </div>

            <div id="group-broadcast-modal" class="modal" style="display: none;">
                <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <h4>Send Group Broadcast</h4>
                    <form id="group-broadcast-form">
                        <div class="form-group">
                            <label for="broadcast-message">Message:</label>
                            <textarea id="broadcast-message" name="message" rows="4" required placeholder="Enter your broadcast message"></textarea>
                            <span id="broadcast-message-error" class="error-message"></span>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="action-button">Send Broadcast</button>
                        </div>
                    </form>
                </div>
            </div>

            <div id="feedback-modal" class="modal" style="display: none;">
                <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <h4>Feedback & Grievances</h4>
                    <form id="feedback-form">
                        <div class="form-group">
                            <label for="feedback-farmer-id">Farmer ID (Optional):</label>
                            <input type="text" id="feedback-farmer-id" name="farmer-id" pattern="[A-Za-z0-9]{5}" maxlength="5" placeholder="Enter Farmer ID (if applicable)"/>
                            <span id="feedback-farmer-id-error" class="error-message"></span>
                        </div>
                        <div class="form-group">
                            <label for="feedback-type">Type:</label>
                            <select id="feedback-type" name="feedback-type">
                                <option value="feedback">Feedback</option>
                                <option value="grievance">Grievance</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="feedback-message">Message:</label>
                            <textarea id="feedback-message" name="message" rows="5" required placeholder="Enter your feedback or grievance"></textarea>
                            <span id="feedback-message-error" class="error-message"></span>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="action-button">Submit</button>
                        </div>
                    </form>
                </div>
            </div>

            <div id="resource-library-modal" class="modal" style="display: none;">
                <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <h4>Resource Library</h4>
                    <p>Here are some helpful resources:</p>
                    <ul>
                        <li><a href="https://farmer.gov.in/" target="_blank">Official Farmer Portal (farmer.gov.in)</a></li>
                        <li><a href="https://agricoop.nic.in/" target="_blank">Department of Agriculture & Cooperation</a></li>
                        <li><a href="https://en.wikipedia.org/wiki/Agriculture_in_India" target="_blank">Agriculture in India - Wikipedia</a></li>
                        <li><a href="https://docs.google.com/document/d/e/2PACX-1vR_z-yv2vE8Yv6vP9eK8mZNG8L5oR9z-F_9fKxK8L9rGgP" target="_blank">Farmer Scheme Details (Sample Google Doc)</a></li>
                    </ul>
                </div>
            </div>


            <section id="performance-analytics-section" style="display: none;">
                <h3><span class="material-symbols-outlined">insights</span> Farmer Performance & Analytics</h3>
                <div class="analytics-dashboards">
                    <div class="chart-container">
                        <h4>Farmer Scorecards</h4>
                        <canvas id="farmer-scorecard-chart"></canvas>
                    </div>
                    <div class="data-table-container">
                        <h4>Farmer Leaderboard</h4>
                        <table id="leaderboard-table" class="data-table">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th class="filterable" data-type="text" data-column="farmerId">Farmer ID <span class="arrow">▼</span></th>
                                    <th class="filterable" data-type="text" data-column="name">Name <span class="arrow">▼</span></th>
                                    <th class="filterable" data-type="number" data-column="score">Score <span class="arrow">▼</span></th>
                                </tr>
                                <tr class="filter-row hidden">
                                    <td></td>
                                    <td><input type="text" class="filter-input" data-column="farmerId" placeholder="Farmer ID"></td>
                                    <td><input type="text" class="filter-input" data-column="name" placeholder="Name"></td>
                                    <td><input type="number" class="filter-input" data-column="score" placeholder="Score"></td>
                                </tr>
                            </thead>
                            <tbody id="leaderboard-table-body">
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <div id="add-farmer-modal" class="modal content-display" style="display: none;">
                <div class="modal-content">
                    <span class="close-button" onclick="closeAddFarmerModal()">&times;</span>
                    <h4>Add New Farmer</h4>
                    <form id="add-farmer-form">
                        <div class="form-group">
                            <label for="farmer-name">Farmer Name:</label>
                            <input type="text" id="farmer-name" name="farmer-name" required pattern="^[A-Za-z\s\-']+$" maxlength="25" title="Farmer Name should not exceed 25 characters" placeholder="Enter Farmer Name"/>
                        </div>
                        <div class="form-group">
                            <label for="farmer-id">Farmer ID:</label>
                            <input type="text" id="farmer-id" name="farmer-id" required pattern="[A-Za-z0-9]{5}" title="Farmer ID must be unique and contain exactly 5 alphanumeric characters" maxlength="5" placeholder="Enter 5-character Farmer ID" />
                        </div>
                        <div class="form-group">
                            <label for="contact">Contact:</label>
                            <input type="tel" id="contact" name="contact" required pattern="^[6-9]{1}[0-9]{9}$" maxlength="10" title="Contact number must start with 6-9 and have 10 digits" placeholder="Enter 10-digit Contact Number" />
                        </div>
                        <div class="form-group">
                            <label for="location">Location:</label>
                            <input type="text" id="location" name="location" required placeholder="Enter Location" />
                        </div>
                        <div class="form-section-label">Bank Details:</div>
                        <fieldset class="bank-details">
                            <div class="form-group">
                                <label for="bank-name">Bank Name:</label>
                                <input type="text" id="bank-name" name="bank-name" required maxlength="50" title="Bank Name should not exceed 50 characters" placeholder="Enter Bank Name"/>
                            </div>
                            <div class="form-group">
                                <label for="ifsc">IFSC:</label>
                                <input type="text" id="ifsc" name="ifsc" required pattern="^[A-Z0-9]{11}$" maxlength="11" title="IFSC Code should contain exactly 11 uppercase letters and numbers" placeholder="Enter 11-character IFSC Code"/>
                            </div>
                            <div class="form-group">
                                <label for="account-number">Account Number:</label>
                                <input type="text" id="account-number" name="account-number" required pattern="^[A-Za-z0-9]{5,20}$" maxlength="20" title="Account number should not exceed 20 characters" placeholder="Enter Account Number"/>
                            </div>
                        </fieldset>
                        <div class="form-group">
                            <label for="aadhar-number">Aadhar Number:</label>
                            <input type="text" id="aadhar-number" name="aadhar-number" required pattern="[0-9]{12}" maxlength="12" title="Aadhar number must be exactly 12 digits" placeholder="Enter 12-digit Aadhar Number" />
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="action-button">Add</button>
                        </div>
                    </form>
                </div>
            </div>

            <div id="add-milk-record-modal" class="modal content-display" style="display: none;">
                <div class="modal-content">
                    <span class="close-button" onclick="closeAddMilkRecordModal()">&times;</span>
                    <h4>Add Milk Record</h4>
                    <form id="add-milk-record-form">
                        <div class="form-group">
                            <label for="milk-farmer">Farmer ID:</label>
                            <input type="text" id="milk-farmer" name="farmer-id" required pattern="[A-Za-z0-9]{5}" title="Farmer ID must be unique and contain exactly 5 alphanumeric characters" maxlength="5" placeholder="Enter Farmer ID"/>
                        </div>
                        <div class="form-group">
                            <label for="milk-date">Supply Date:</label>
                            <input type="date" id="milk-date" name="supply-date" required placeholder="Select Supply Date"/>
                        </div>
                        <div class="form-group">
                            <label for="milk-quantity">Quantity (Liters):</label>
                            <input type="number" id="milk-quantity" name="milk-quantity" required min="0" step="0.01" placeholder="Enter Quantity in Liters"/>
                        </div>
                        <div class="form-group">
                            <label for="fat-content">Fat Content (%):</label>
                            <input type="number" id="fat-content" name="fat-content" required min="0" max="100" step="0.01" placeholder="Enter Fat Content (%)"/>
                        </div>
                        <div class="form-group">
                            <label for="snf-value">SNF Value:</label>
                            <input type="number" id="snf-value" name="snf-value" required min="0" max="100" step="0.01" placeholder="Enter SNF Value"/>
                        </div>
                        <div class="form-group">
                            <label for="price-per-liter">Price per Liter (₹):</label>
                            <input type="number" id="price-per-liter" name="price-per-liter" required min="0" step="0.01" placeholder="Enter Price per Liter"/>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="action-button">Add Record</button>
                        </div>
                    </form>
                </div>
            </div>

            <div id="add-payment-modal" class="modal content-display" style="display: none;">
                <div class="modal-content">
                    <span class="close-button" onclick="closeAddPaymentModal()">&times;</span>
                    <h4>Record Payment</h4>
                    <form id="add-payment-form">
                        <div class="form-group">
                            <label for="payment-farmer">Farmer ID:</label>
                            <input type="text" id="payment-farmer" name="farmer-id" required pattern="[A-Za-z0-9]{5}" title="Farmer ID must be unique and contain exactly 5 alphanumeric characters" maxlength="5" placeholder="Enter Farmer ID"/>
                        </div>
                        <div class="form-group">
                            <label for="payment-date">Payment Date:</label>
                            <input type="date" id="payment-date" name="payment-date" required placeholder="Select Payment Date"/>
                        </div>
                        <div class="form-group">
                            <label for="payment-amount">Amount (₹):</label>
                            <input type="number" id="payment-amount" name="payment-amount" required min="0" step="0.01" placeholder="Enter Payment Amount"/>
                        </div>
                        <div class="form-group">
                            <label for="payment-method">Payment Method:</label>
                            <select id="payment-method" name="payment-method" required>
                                <option value="" disabled selected hidden>Select Method</option>
                                <option value="cash">Cash</option>
                                <option value="cheque">Cheque</option>
                                <option value="online">Online Transfer</option>
                                <option value="card">Card Payment</option>
                                <option value="upi">UPI</option>
                            </select>
                        </div>
                        <div id="receipt-upload-container" style="display: none;">
                            <label for="payment-receipt">Upload Receipt (Max 2MB, Image/PDF):</label>
                            <input type="file" id="payment-receipt" name="payment-receipt" accept="image/*,.pdf" max-size="2097152">
                        </div>
                        <div class="form-group">
                            <label for="remarks">Remarks:</label>
                            <textarea id="remarks" name="remarks" placeholder="Optional remarks..." rows="3"></textarea>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="action-button">Record Payment</button>
                        </div>
                    </form>
                </div>
            </div>

            </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="farmer.js"></script>
</body>
</html>